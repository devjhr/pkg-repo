<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>AndroStudio â€” Package Repository</title>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,300;0,400;0,700;1,300&family=Bebas+Neue&display=swap" rel="stylesheet"/>
  <style>
    *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

    :root {
      --bg: #060809;
      --surface: #0b0f12;
      --border: #1a2028;
      --green: #00ff88;
      --green-dim: rgba(0,255,136,0.06);
      --text: #cdd8e3;
      --muted: #445566;
      --amber: #ffb347;
      --blue: #4fc3f7;
    }

    html { scroll-behavior: smooth; }

    body {
      background: var(--bg);
      color: var(--text);
      font-family: 'JetBrains Mono', monospace;
      min-height: 100vh;
      overflow-x: hidden;
    }

    /* Scanlines */
    body::after {
      content: '';
      position: fixed; inset: 0;
      background: repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(0,0,0,0.03) 2px, rgba(0,0,0,0.03) 4px);
      pointer-events: none; z-index: 9999;
    }

    /* Grid bg */
    body::before {
      content: '';
      position: fixed; inset: 0;
      background-image: linear-gradient(var(--border) 1px, transparent 1px), linear-gradient(90deg, var(--border) 1px, transparent 1px);
      background-size: 40px 40px;
      opacity: 0.25; pointer-events: none;
    }

    /* TOP BAR */
    .topbar {
      background: var(--surface);
      border-bottom: 1px solid var(--border);
      padding: 10px 40px;
      display: flex; align-items: center; gap: 12px;
      font-size: 0.7rem; color: var(--muted);
      position: sticky; top: 0; z-index: 100;
    }
    .topbar-dot { width: 8px; height: 8px; border-radius: 50%; }
    .dot-red    { background: #ff5f57; }
    .dot-yellow { background: #febc2e; }
    .dot-green  { background: #28c840; }
    .topbar-title { margin-left: 16px; color: var(--text); font-size: 0.72rem; }
    .topbar-status { margin-left: auto; display: flex; align-items: center; gap: 8px; }
    .status-dot {
      width: 6px; height: 6px; border-radius: 50%;
      background: var(--green);
      animation: blink 2s infinite;
    }
    @keyframes blink { 0%,100%{opacity:1} 50%{opacity:0.3} }

    /* HERO */
    .hero { padding: 80px 40px 60px; max-width: 960px; margin: 0 auto; }
    .hero-label {
      font-size: 0.68rem; letter-spacing: 0.2em;
      color: var(--green); text-transform: uppercase;
      margin-bottom: 20px; display: block;
      opacity: 0; animation: fadeIn 0.6s 0.1s forwards;
    }
    .hero-title {
      font-family: 'Bebas Neue', sans-serif;
      font-size: clamp(4rem, 10vw, 9rem);
      line-height: 0.9; color: var(--text);
      margin-bottom: 8px;
      opacity: 0; animation: fadeIn 0.6s 0.2s forwards;
    }
    .hero-title span { color: var(--green); }
    .hero-sub {
      font-family: 'Bebas Neue', sans-serif;
      font-size: clamp(1.5rem, 4vw, 3rem);
      color: var(--muted); margin-bottom: 40px;
      opacity: 0; animation: fadeIn 0.6s 0.3s forwards;
    }
    .hero-desc {
      font-size: 0.82rem; line-height: 1.9;
      color: var(--muted); max-width: 560px; margin-bottom: 50px;
      opacity: 0; animation: fadeIn 0.6s 0.4s forwards;
    }

    /* INSTALL BLOCK */
    .install-block {
      background: var(--surface);
      border: 1px solid var(--border);
      border-left: 3px solid var(--green);
      padding: 24px 28px; margin-bottom: 14px;
      opacity: 0; animation: fadeIn 0.6s 0.5s forwards;
    }
    .install-block-label {
      font-size: 0.62rem; letter-spacing: 0.18em;
      color: var(--green); text-transform: uppercase;
      margin-bottom: 14px; display: block;
    }
    .cmd-line { display: flex; align-items: center; gap: 10px; margin-bottom: 10px; }
    .cmd-line:last-child { margin-bottom: 0; }
    .prompt { color: var(--green); font-size: 0.85rem; user-select: none; }
    .cmd { font-size: 0.85rem; color: var(--text); flex: 1; word-break: break-all; }
    .copy-btn {
      background: none; border: 1px solid var(--border);
      color: var(--muted); font-family: 'JetBrains Mono', monospace;
      font-size: 0.62rem; letter-spacing: 0.1em;
      padding: 4px 10px; cursor: pointer;
      text-transform: uppercase; white-space: nowrap;
      transition: border-color 0.2s, color 0.2s;
    }
    .copy-btn:hover { border-color: var(--green); color: var(--green); }
    .copy-btn.copied { color: var(--green); border-color: var(--green); }

    /* DIVIDER */
    .divider {
      display: flex; align-items: center; gap: 16px;
      margin: 60px 0 40px;
    }
    .divider-line { flex: 1; height: 1px; background: var(--border); }
    .divider-text { font-size: 0.68rem; letter-spacing: 0.18em; color: var(--muted); text-transform: uppercase; white-space: nowrap; }

    /* FILE MANAGER */
    .fm-section { max-width: 960px; margin: 0 auto; padding: 0 40px 80px; }

    /* Breadcrumb */
    .fm-breadcrumb {
      display: flex; align-items: center; gap: 6px;
      font-size: 0.72rem; color: var(--muted);
      margin-bottom: 16px; flex-wrap: wrap;
    }
    .fm-breadcrumb span { color: var(--muted); }
    .fm-breadcrumb a {
      color: var(--green); text-decoration: none;
      cursor: pointer;
    }
    .fm-breadcrumb a:hover { text-decoration: underline; }

    /* Toolbar */
    .fm-toolbar {
      display: flex; align-items: center; gap: 12px;
      margin-bottom: 14px; flex-wrap: wrap;
    }
    .fm-search {
      flex: 1; min-width: 180px;
      background: var(--surface);
      border: 1px solid var(--border);
      color: var(--text);
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.78rem;
      padding: 8px 14px;
      outline: none;
      transition: border-color 0.2s;
    }
    .fm-search:focus { border-color: var(--green); }
    .fm-search::placeholder { color: var(--muted); }
    .fm-count {
      font-size: 0.68rem; color: var(--muted);
      white-space: nowrap;
    }

    /* File manager shell */
    .fm-shell {
      border: 1px solid var(--border);
      background: var(--surface);
      overflow: hidden;
    }

    /* Column headers */
    .fm-header {
      display: grid;
      grid-template-columns: 24px 1fr 90px 100px 110px;
      gap: 0;
      padding: 10px 16px;
      border-bottom: 1px solid var(--border);
      background: #0d1219;
      font-size: 0.62rem; letter-spacing: 0.14em;
      text-transform: uppercase; color: var(--muted);
      user-select: none;
    }

    /* Rows */
    .fm-row {
      display: grid;
      grid-template-columns: 24px 1fr 90px 100px 110px;
      gap: 0;
      padding: 0 16px;
      border-bottom: 1px solid var(--border);
      align-items: center;
      min-height: 44px;
      cursor: pointer;
      transition: background 0.12s;
      text-decoration: none; color: inherit;
    }
    .fm-row:last-child { border-bottom: none; }
    .fm-row:hover { background: var(--green-dim); }
    .fm-row.fm-folder:hover .fm-name { color: var(--green); }

    .fm-icon { font-size: 1rem; display: flex; align-items: center; }
    .fm-name {
      font-size: 0.8rem; color: var(--text);
      white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
      padding-right: 12px;
      transition: color 0.15s;
    }
    .fm-name.folder-name { color: var(--blue); font-weight: 700; }
    .fm-version { font-size: 0.7rem; color: var(--amber); }
    .fm-size { font-size: 0.7rem; color: var(--muted); }
    .fm-action { display: flex; justify-content: flex-end; }
    .fm-dl-btn {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.62rem; letter-spacing: 0.08em;
      text-transform: uppercase;
      padding: 4px 10px;
      border: 1px solid var(--border);
      color: var(--muted);
      text-decoration: none;
      transition: border-color 0.2s, color 0.2s;
      white-space: nowrap;
    }
    .fm-dl-btn:hover { border-color: var(--green); color: var(--green); }

    /* Up row (go back) */
    .fm-up { color: var(--muted); }
    .fm-up .fm-name { color: var(--muted); font-style: italic; }

    /* Empty state */
    .fm-empty {
      padding: 48px; text-align: center;
      font-size: 0.78rem; color: var(--muted);
    }

    /* FOOTER */
    footer {
      border-top: 1px solid var(--border);
      padding: 28px 40px;
      display: flex; justify-content: space-between; align-items: center;
      font-size: 0.68rem; color: var(--muted);
    }
    .footer-logo { color: var(--green); font-weight: 700; }

    /* ANIMATIONS */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(16px); }
      to   { opacity: 1; transform: translateY(0); }
    }
    .reveal { opacity: 0; transform: translateY(20px); transition: opacity 0.5s, transform 0.5s; }
    .reveal.visible { opacity: 1; transform: translateY(0); }

    @media (max-width: 640px) {
      .hero, .fm-section { padding-left: 16px; padding-right: 16px; }
      .topbar { padding: 10px 16px; }
      .fm-header, .fm-row { grid-template-columns: 20px 1fr 70px 0 80px; }
      .fm-header > :nth-child(4), .fm-row > :nth-child(4) { display: none; }
      footer { flex-direction: column; gap: 10px; text-align: center; }
    }
  </style>
</head>
<body>

  <!-- Topbar -->
  <div class="topbar">
    <div class="topbar-dot dot-red"></div>
    <div class="topbar-dot dot-yellow"></div>
    <div class="topbar-dot dot-green"></div>
    <span class="topbar-title">androstudio â€” pkg repository</span>
    <div class="topbar-status">
      <div class="status-dot"></div>
      <span>repo online</span>
    </div>
  </div>

  <!-- Hero -->
  <div class="hero">
    <span class="hero-label">// Official Package Repository</span>
    <h1 class="hero-title">Andro<span>Studio</span></h1>
    <p class="hero-sub">PKG Repository</p>
    <p class="hero-desc">
      Official package repository for AndroStudio's built-in terminal.
      Built for <strong style="color:var(--text)">aarch64</strong> Android devices.
    </p>

    <!-- Install block (Step 2 only) -->
    <div class="install-block">
      <span class="install-block-label">Install a package</span>
      <div class="cmd-line">
        <span class="prompt">$</span>
        <span class="cmd" id="cmd1">pkg install git</span>
        <button class="copy-btn" onclick="copyCmd('cmd1',this)">copy</button>
      </div>
      <div class="cmd-line">
        <span class="prompt">$</span>
        <span class="cmd" id="cmd2">pkg install python</span>
        <button class="copy-btn" onclick="copyCmd('cmd2',this)">copy</button>
      </div>
      <div class="cmd-line">
        <span class="prompt">$</span>
        <span class="cmd" id="cmd3">pkg install micro</span>
        <button class="copy-btn" onclick="copyCmd('cmd3',this)">copy</button>
      </div>
    </div>
  </div>

  <!-- File Manager Section -->
  <div class="fm-section">
    <div class="divider reveal">
      <div class="divider-line"></div>
      <span class="divider-text">ğŸ“ pool / main</span>
      <div class="divider-line"></div>
    </div>

    <!-- Breadcrumb -->
    <div class="fm-breadcrumb" id="breadcrumb">
      <a onclick="navigateTo(null)">pool/main</a>
    </div>

    <!-- Toolbar -->
    <div class="fm-toolbar reveal">
      <input class="fm-search" id="searchInput" type="text" placeholder="Search packages..." oninput="renderView()"/>
      <span class="fm-count" id="itemCount"></span>
    </div>

    <!-- Shell -->
    <div class="fm-shell reveal" id="fmShell">
      <div class="fm-header">
        <div></div>
        <div>Name</div>
        <div>Version</div>
        <div>Size</div>
        <div></div>
      </div>
      <div id="fmBody">
        <div class="fm-empty">Loading packages...</div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer>
    <span><span class="footer-logo">AndroStudio</span> â€” PKG Repository Â· aarch64</span>
    <span>Hosted on GitHub Pages Â· <a href="https://github.com/devjhr" style="color:var(--green);text-decoration:none;">@devjhr</a></span>
  </footer>

  <script>
    // â”€â”€ Repo base URL (update if you rename the GitHub Pages repo) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const REPO_BASE = 'https://devjhr.github.io/pkg-repo';

    // â”€â”€ State â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    let allFolders  = {};   // raw data from packages.json  { "m": [...], "g": [...] }
    let currentPath = null; // null = root, string = open folder name

    // â”€â”€ Boot â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    fetch('packages.json')
      .then(r => r.json())
      .then(data => { allFolders = data; renderView(); })
      .catch(() => {
        document.getElementById('fmBody').innerHTML =
          '<div class="fm-empty">âš  packages.json not found â€” run generate_repo.py and push.</div>';
      });

    // â”€â”€ Navigation â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function navigateTo(folder) {
      currentPath = folder;
      document.getElementById('searchInput').value = '';
      renderView();
    }

    // â”€â”€ Render â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function renderView() {
      const query = document.getElementById('searchInput').value.trim().toLowerCase();
      const body  = document.getElementById('fmBody');
      const crumb = document.getElementById('breadcrumb');
      let html = '';
      let count = 0;

      if (currentPath === null) {
        // ROOT VIEW â€” show folders + search across all files
        crumb.innerHTML = '<span style="color:var(--green)">pool/main</span>';

        if (query) {
          // Search mode: flatten all files
          const matches = [];
          for (const [folder, files] of Object.entries(allFolders)) {
            files.forEach(f => {
              if (f.name.toLowerCase().includes(query) || f.package.toLowerCase().includes(query)) {
                matches.push({ ...f, folder });
              }
            });
          }
          count = matches.length;
          if (!matches.length) {
            html = '<div class="fm-empty">No packages match "' + query + '"</div>';
          } else {
            matches.forEach(f => { html += fileRow(f, f.folder); });
          }
        } else {
          // Normal root: show alphabet folders
          const folders = Object.keys(allFolders).sort();
          count = folders.length;
          if (!folders.length) {
            html = '<div class="fm-empty">No packages yet â€” add .deb files to pool/main/ and run generate_repo.py</div>';
          } else {
            folders.forEach(folder => {
              const files = allFolders[folder];
              const n = files.length;
              html += `
                <div class="fm-row fm-folder" onclick="navigateTo('${folder}')">
                  <div class="fm-icon">ğŸ“</div>
                  <div class="fm-name folder-name">${folder}/</div>
                  <div class="fm-version" style="color:var(--muted)">${n} pkg${n!==1?'s':''}</div>
                  <div class="fm-size">â€”</div>
                  <div class="fm-action"></div>
                </div>`;
            });
          }
        }

      } else {
        // FOLDER VIEW â€” show files inside the folder
        crumb.innerHTML = `<a onclick="navigateTo(null)">pool/main</a> <span>/</span> <span style="color:var(--green)">${currentPath}/</span>`;

        let files = (allFolders[currentPath] || []).filter(f =>
          !query || f.name.toLowerCase().includes(query) || f.package.toLowerCase().includes(query)
        );
        count = files.length;

        // Up row
        html += `
          <div class="fm-row fm-up" onclick="navigateTo(null)">
            <div class="fm-icon">â†©</div>
            <div class="fm-name">.. (back)</div>
            <div class="fm-version"></div>
            <div class="fm-size"></div>
            <div class="fm-action"></div>
          </div>`;

        if (!files.length) {
          html += '<div class="fm-empty">No packages match your search.</div>';
        } else {
          files.forEach(f => { html += fileRow(f, currentPath); });
        }
      }

      body.innerHTML = html;
      document.getElementById('itemCount').textContent =
        currentPath ? `${count} file${count!==1?'s':''}` : (query ? `${count} result${count!==1?'s':''}` : `${count} folder${count!==1?'s':''}`);
    }

    // â”€â”€ File row helper â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function fileRow(f, folder) {
      const dlUrl  = `${REPO_BASE}/${f.path}`;
      const sizeKB = f.size ? (f.size / 1024).toFixed(0) + ' KB' : 'â€”';
      return `
        <div class="fm-row" title="${f.desc || ''}">
          <div class="fm-icon">ğŸ“¦</div>
          <div class="fm-name">${f.name}</div>
          <div class="fm-version">${f.version || 'â€”'}</div>
          <div class="fm-size">${sizeKB}</div>
          <div class="fm-action">
            <a class="fm-dl-btn" href="${dlUrl}" download title="Download ${f.name}">â†“ .deb</a>
          </div>
        </div>`;
    }

    // â”€â”€ Copy command â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function copyCmd(id, btn) {
      navigator.clipboard.writeText(document.getElementById(id).textContent).then(() => {
        btn.textContent = 'copied!'; btn.classList.add('copied');
        setTimeout(() => { btn.textContent = 'copy'; btn.classList.remove('copied'); }, 2000);
      });
    }

    // â”€â”€ Scroll reveal â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const obs = new IntersectionObserver(entries => {
      entries.forEach(e => { if (e.isIntersecting) e.target.classList.add('visible'); });
    }, { threshold: 0.1 });
    document.querySelectorAll('.reveal').forEach(el => obs.observe(el));
  </script>
</body>
</html>

